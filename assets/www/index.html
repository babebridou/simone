<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">

<title>SiMone</title>

<script data-pace-options='{ "eventLag": true }' src="./libs/pace.js"></script>
<link href="./libs/pace-theme-minimal.css" rel="stylesheet" />

<script type="text/javascript" src="//use.typekit.net/jbn8qxr.js"></script>
<link rel="stylesheet" href="http://use.typekit.net/c/b733af/ff-tisa-web-pro:n4,proxima-nova:n1:n3:n4:n6:n7,proxima-nova-condensed:i4:i7:n4:n7.Vdk:N:2,Vmv:N:2,Vmx:N:2,W0V:N:2,W0X:N:2,W0Y:N:2,SCb:N:2,SCW:N:2,SCZ:N:2,SCV:N:2/d?3bb2a6e53c9684ffdc9a99f2135b2a62530e2147042b974e71a2d7029d1601787957a80784278ac260ccf9d3910532987a4dfc535707a67e8341fb623b171efc1f1ba756025299c0667a80b9e0df64675fd9b263d35af1eeef42c42e571d3cdba78c16d2c5e2962e552477be5566c1bbaddae866289f59188c33a3a92b259b1b54fd56e22ebefc84fbc517723f3a00d40f0ad6dea566d765337f78010b44cfd614cc1cd31e925d2bdfc452c863eee019a6e7811c5da93933281c9f33c4e24d74e5b6ea8144d73d7a7b5b099e1c115d9a9338479c9765fc6264b8aa05c04e3c0a29fa233701d8398c3edb7c98ac13a1eea0958e2b0e42d36fd3f06dd3681f90508712a4e7e90d30e483b76fcdd2bfd528640c33879bb50befce154f44202e21fdabaea62d1d22f38894f20561d666f699e6be55c0871c5b3e53f9ce040789ebbff348b7bf04f9321dfe05be013b3e446f326ee7e49a9613b145c8458f46">
<script type="text/javascript">try{Typekit.load();}catch(e){}</script>

<script src="libs/d3.v3.min.js"></script>
<script src="./libs/bean.js"></script>
<script src="./libs/jquery-2.0.3.js"></script>
<script src="./service/theoricset.js"></script>
<script src="./indicators/sampleReport.js"></script>
<script src="./indicators/testAlertReport.js"></script>
<script src="./service/core.js"></script>
<script src="./service/utils.js"></script>
<script src="./service/app.js"></script>
<script src="./service/service.js"></script>
<link href='./css/main.css' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Oxygen:400,300,700' rel='stylesheet' type='text/css'>

<script>

	
	function initApp(){
		var uiScreen = $("<div>").attr("id","uiScreen").appendTo($("body"));
		window.simulationDelay = 100;
		window.transitionDuration = 500;
		var durationControlDiv = $("<div>").attr("id","durationControl").appendTo(uiScreen);
		var inputSlider = $("<input>")
			.attr("id", "speedControl")
			.attr("type","range")
			.attr("name", "vitesse de simulation")
			.attr("min", 1)
			.attr("max", 10)
			.on("input change", function(){
				var speed = $(this).val();
				console.debug("speed changed ", speed);
				switch(speed){
					case 0:
						window.simulationDelay = 30000*60;
						// window.transitionDuration = 10000-10;
					break;
					default:
						window.simulationDelay = 5000/speed;
						// window.transitionDuration = 3000/speed-10;
						break;
				}
				bean.fire(inputSlider,'speedChanged', [window.simulationDelay, window.transitionDuration]);
			})
			.appendTo(durationControlDiv);
		
		
		var reportDiv = $("<div>").attr("id","report").appendTo(uiScreen);
		var alertDiv = $("<div>").attr("id","alert").appendTo(uiScreen);
		
		var authorizationToken = "Basic TlJKSGFjazp4NTJqU2g2VXIzUw==";
		
// 		EnergyHack.sample(function(data){
// 			var res = JSON.parse(data);
//  	   		console.debug("service called",res);
// 	   		var sampleReport = new SampleReport("report");
// 	   		sampleReport.setData(res);
// 	   	});
		
// 		EnergyHack.service({
// 			"jsonrpc":"2.0",
// 			"method":"energy",
// 			"params":[
// 			          {
// 			        	  "prog":"CERGY01",
// 			        	  "build":"BatimentB",
// 			        	  "lots":["B123"],
// 			        	  "ctx":"GLOBAL",
// 			        	  "types":["TEMPER"],
// 			        	  "ind":0,
// 			        	  "gran":"HOUR", //"LAST","DAY","MONTH","HOUR"
// 			        	  "begin":new Date().getTime()-24*60*60*1000,
// 			        	  "end":new Date().getTime(),
// 			        }],
// 			"id":"energyhack007"
// 		},function(data){
// 			var res = JSON.parse(data);
//  	   		console.debug("service called",res);
// 	   		var sampleReport = new SampleReport("report");
// 	   		sampleReport.setData(res);
// 	   	});
		

		var sampleReport = new SampleReport("report");
		var model = [{
			label:"Température",
			value:3,
			target:19,
			max:0,
			min:0,
			unit:"ºC",
			color:"#f0e6d8",
			ringColor:"#9e6b56",
			lineColor:"#dd7a55",
			pieArc:10,
		},{
			label:"Air",
			value:-1000,
			target:32,
			max:0,
			min:0,
			unit:"ppm",
			color:"#d9e1dc",
			ringColor:"#063968",
			lineColor:"#18004d",
			pieArc:10,
		},{
			label:"Lumière",
			value:-200,
			target:120,
			max:0,
			min:0,
			unit:"Lux",
			color:"#e7ebdb",
			ringColor:"#7a675b",
			lineColor:"#468c24",
			pieArc:10,
		}
	];
		sampleReport.update(model);
		var testAlertReport = new AlertReport("alert");

		bean.on(simone, 'state', function(s) {
		    console.log(s);
		    sampleReport.setData(s);
		    testAlertReport.setData(s);
		});

		bean.on(inputSlider, 'speedChanged', function(simulationSpeed, transitionSpeed) {
		    sampleReport.speedChanged(transitionSpeed);
		    simone.changeRate(simulationSpeed);
		});

		// wait a little before showing the report
// 		uiScreen.hide();
// 		setTimeout(function(){ 
// 			$('.header').fadeOut();
// 			uiScreen.fadeIn();
// 		}, 5000);		
	}

</script>

</head>
<body onLoad="initApp();">
	<div class="header">
	    <div class="title">
	        <h1 class="title1"><span class="char1">s</span><span class="char2">i</span><span class="char3">m</span><span class="char4">o</span><span class="char5">n</span><span class="char6">e</span></h1>
	        <h1 class="title2"><span class="char1">s</span><span class="char2">i</span><span class="char3">m</span><span class="char4">o</span><span class="char5">n</span><span class="char6">e</span></h1>
	    </div>
	    <div class="subtitle">
	        <h3>Votre comfort en un clin d'oeil</h3>
	    </div>
	</div>

	<script>
		// animate letters
		setTimeout(function(){ document.body.className = 'page-loaded' }, 0);
	</script>
</body>
</html>